<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>TTFKD – Topluluk Anketi (Final)</title>
<style>
  :root { --bg:#0b132b; --card:#1c2541; --ink:#eaf0ff; --accent:#3a86ff; --muted:#a9b4d0; }
  *{box-sizing:border-box}
  body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:linear-gradient(180deg,#0b132b,#0b132b 40%,#1c2541);color:var(--ink)}
  header{padding:24px 16px;border-bottom:1px solid #2d3a63;position:sticky;top:0;background:#0b132bd9;backdrop-filter: blur(6px);}
  header h1{margin:0;font-size:20px;line-height:1.3}
  main{max-width:920px;margin:0 auto;padding:24px 16px 96px}
  .card{background:var(--card);border:1px solid #2d3a63;border-radius:16px;padding:20px;margin-bottom:16px;box-shadow:0 8px 24px rgba(0,0,0,.25)}
  h2{font-size:18px;margin:0 0 10px 0;color:#cdd7ff}
  label{display:block;font-size:14px;margin-bottom:6px;color:var(--muted)}
  input[type="text"], input[type="email"], input[type="tel"], textarea, select {
    width:100%;padding:10px 12px;border-radius:10px;border:1px solid #2d3a63;background:#11172b;color:var(--ink)
  }
  textarea{min-height:96px;resize:vertical}
  .opt{display:flex;gap:12px;flex-wrap:wrap;margin:6px 0 14px}
  .opt label{display:flex;gap:8px;align-items:center;background:#11172b;border:1px solid #2d3a63;color:var(--ink);padding:8px 12px;border-radius:999px;cursor:pointer}
  .opt input{accent-color:var(--accent)}
  .actions{display:flex;flex-wrap:wrap;gap:12px;margin-top:12px}
  button{appearance:none;border:0;border-radius:12px;padding:12px 16px;font-weight:600;cursor:pointer}
  .primary{background:var(--accent);color:white}
  .ghost{background:transparent;border:1px solid #2d3a63;color:var(--ink)}
  .success{color:#90ee90;margin-left:8px}
  .req{color:#ffb703;margin-left:6px;font-size:12px}
  footer{position:fixed;bottom:0;left:0;right:0;background:#0b132bd9;border-top:1px solid #2d3a63;padding:10px 16px;display:flex;gap:10px;justify-content:center}
  small{color:var(--muted)}
</style>
</head>
<body>
  <header>
    <h1>Toronto Türk Folklor ve Kültür Derneği – Topluluk Anketi</h1>
    <small>Lütfen aşağıdaki kısa anketi doldurunuz. • <em>Zorunlu alanlar *</em></small>
  </header>
  <main>
    <form id="anketForm">
      <!-- Katılımcı Bilgileri -->
      <section class="card">
        <h2>Katılımcı Bilgileri</h2>
        <label>Ad Soyad <span class="req">*</span></label>
        <input type="text" name="ad_soyad" required placeholder="Adınız ve soyadınız">
        <div class="opt" style="gap:16px;flex-wrap:wrap">
          <div style="flex:1;min-width:220px">
            <label>E-posta <span class="req">*</span></label>
            <input type="email" name="email" required placeholder="ornek@posta.com">
          </div>
          <div style="flex:1;min-width:220px">
            <label>Telefon</label>
            <input type="tel" name="telefon" placeholder="+1 416 ...">
          </div>
        </div>
      </section>

      <!-- Demografi -->
      <section class="card">
        <h2>Demografi</h2>
        <label>Yaşınız nedir? <span class="req">*</span></label>
        <div class="opt">
          <label><input type="radio" name="yas" value="18 altı" required>18 altı</label>
          <label><input type="radio" name="yas" value="18–24">18–24</label>
          <label><input type="radio" name="yas" value="25–34">25–34</label>
          <label><input type="radio" name="yas" value="35–44">35–44</label>
          <label><input type="radio" name="yas" value="45–54">45–54</label>
          <label><input type="radio" name="yas" value="55+">55+</label>
        </div>
        <label>Cinsiyetiniz nedir? <span class="req">*</span></label>
        <div class="opt">
          <label><input type="radio" name="cinsiyet" value="Kadın" required>Kadın</label>
          <label><input type="radio" name="cinsiyet" value="Erkek">Erkek</label>
          <label><input type="radio" name="cinsiyet" value="Diğer / Belirtmek istemiyorum">Diğer / Belirtmek istemiyorum</label>
        </div>
      </section>

      <!-- Bizi nereden duydunuz -->
      <section class="card">
        <h2>Bizi nereden duydunuz?</h2>
        <div class="opt">
          <label><input type="radio" name="kaynak" value="Instagram">Instagram</label>
          <label><input type="radio" name="kaynak" value="Facebook">Facebook</label>
          <label><input type="radio" name="kaynak" value="WhatsApp grupları">WhatsApp grupları</label>
          <label><input type="radio" name="kaynak" value="Arkadaş/çevre">Arkadaş/çevre</label>
          <label><input type="radio" name="kaynak" value="Etkinlik afişi/stand">Etkinlik afişi/stand</label>
          <label><input type="radio" name="kaynak" value="Diğer">Diğer</label>
        </div>
        <label>“Diğer” ise belirtiniz</label>
        <input type="text" name="kaynak_diger" placeholder="Örn. web sitesi, e-posta, yerel dernek vb.">
      </section>

      <!-- Etkinliklerden beklentileriniz -->
      <section class="card">
        <h2>Etkinliklerden beklentileriniz</h2>
        <label>Açık uçlu beklentileriniz</label>
        <textarea name="beklentiler" placeholder="Program içeriği, mekan, fiyat, saat, çocuklara uygunluk vb."></textarea>

        <label>İlginizi çeken etkinlik türleri (isteğe bağlı çoklu seçim)</label>
        <div class="opt">
          <label><input type="checkbox" name="ilgi" value="Konser / Müzik">Konser / Müzik</label>
          <label><input type="checkbox" name="ilgi" value="Halk Dansları / Folklor">Halk Dansları / Folklor</label>
          <label><input type="checkbox" name="ilgi" value="Çocuk etkinlikleri">Çocuk etkinlikleri</label>
          <label><input type="checkbox" name="ilgi" value="Türk Sineması / Film">Türk Sineması / Film</label>
          <label><input type="checkbox" name="ilgi" value="Kültürel Geziler">Kültürel Geziler</label>
          <label><input type="checkbox" name="ilgi" value="Seminer / Panel">Seminer / Panel</label>
          <label><input type="checkbox" name="ilgi" value="Yemek & Gastronomi">Yemek & Gastronomi</label>
          <label><input type="checkbox" name="ilgi" value="Spor / Turnuvalar">Spor / Turnuvalar</label>
        </div>
      </section>

      <!-- İletişim & Sosyal Medya -->
      <section class="card">
        <h2>İletişim & Sosyal Medya</h2>
        <label>İletişim için tercih ettiğiniz yöntem <span class="req">*</span></label>
        <div class="opt">
          <label><input type="radio" name="iletisim_tercih" value="E-posta" required>E-posta</label>
          <label><input type="radio" name="iletisim_tercih" value="WhatsApp">WhatsApp</label>
          <label><input type="radio" name="iletisim_tercih" value="Telefon">Telefon</label>
          <label><input type="radio" name="iletisim_tercih" value="Sosyal Medya">Sosyal Medya</label>
        </div>

        <label>Aktif kullandığınız sosyal medya platformları (çoklu seçim) <span class="req">*</span></label>
        <div class="opt">
          <label><input type="checkbox" name="sosyal_medya" value="Instagram" required>Instagram</label>
          <label><input type="checkbox" name="sosyal_medya" value="Facebook">Facebook</label>
          <label><input type="checkbox" name="sosyal_medya" value="TikTok">TikTok</label>
          <label><input type="checkbox" name="sosyal_medya" value="Twitter (X)">Twitter (X)</label>
          <label><input type="checkbox" name="sosyal_medya" value="LinkedIn">LinkedIn</label>
          <label><input type="checkbox" name="sosyal_medya" value="YouTube">YouTube</label>
        </div>

        <label>Derneğimizi sosyal medyada takip ediyor musunuz? <span class="req">*</span></label>
        <div class="opt">
          <label><input type="radio" name="takip" value="Evet" required>Evet</label>
          <label><input type="radio" name="takip" value="Hayır">Hayır</label>
        </div>
      </section>

      <div class="actions">
        <button type="submit" class="primary">Yanıtı Kaydet</button>
        <button type="button" id="exportCsv" class="ghost">Tüm Yanıtları CSV Olarak İndir</button>
        <span id="saveMsg" class="success"></span>
      </div>
    </form>

    <div class="card">
      <h2>Notlar</h2>
      <ul>
        <li>Bu form, talep ettiğiniz bütün alanları içerir: <em>Ad Soyad, E-posta, Telefon, Demografi, Bizi nereden duydunuz?, Etkinlik beklentileri, İletişim & Sosyal Medya</em>.</li>
        <li>Yanıtlar tarayıcı <strong>LocalStorage</strong>'a kaydedilir ve <em>CSV</em> olarak indirilebilir.</li>
        <li>İsterseniz yanıtların Google Sheet'e akması için kolay bir bağlantı ekleyebilirim.</li>
      </ul>
    </div>
  </main>

  <footer>
    <small>© Toronto Türk Folklor ve Kültür Derneği</small>
  </footer>

<script>
(function(){
  const form = document.getElementById('anketForm');
  const saveMsg = document.getElementById('saveMsg');
  const exportBtn = document.getElementById('exportCsv');
  const KEY = 'ttfkd_anket_responses_final_v1';

  function serialize(form){
    const data = {};
    const fd = new FormData(form);
    // group checkboxes by name
    const checkboxGroups = {};
    form.querySelectorAll('input[type="checkbox"]').forEach(cb => checkboxGroups[cb.name] = true);
    for (const [k, v] of fd.entries()){
      if (checkboxGroups[k]){
        if (!data[k]) data[k] = [];
        data[k].push(v);
      } else {
        data[k] = v;
      }
    }
    // ensure empty arrays exist for non-checked groups
    Object.keys(checkboxGroups).forEach(k => { if (!data[k]) data[k] = []; });
    return data;
  }

  function loadAll(){
    try{ return JSON.parse(localStorage.getItem(KEY) || '[]'); }catch(e){ return []; }
  }
  function save(data){
    const all = loadAll();
    all.push({ts: new Date().toISOString(), ...data});
    localStorage.setItem(KEY, JSON.stringify(all));
  }
  function toCsv(rows){
    if (!rows.length) return '';
    const headers = Object.keys(rows[0]);
    const esc = s => {
      s = Array.isArray(s) ? s.join(' | ') : (s ?? '');
      s = String(s).replace(/"/g,'""');
      return `"${s}"`;
    };
    const head = headers.map(esc).join(',');
    const body = rows.map(r => headers.map(h => esc(r[h])).join(',')).join('\n');
    return head + '\n' + body;
  }
  function download(filename, content){
    const blob = new Blob([content], {type:'text/csv;charset=utf-8;'});
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = filename;
    a.click();
    URL.revokeObjectURL(a.href);
  }

  form.addEventListener('submit', e => {
    e.preventDefault();
    save(serialize(form));
    saveMsg.textContent = 'Yanıt kaydedildi ✔';
    setTimeout(()=> saveMsg.textContent = '', 2500);
    form.reset();
    window.scrollTo({top:0,behavior:'smooth'});
  });
  exportBtn.addEventListener('click', () => {
    const all = loadAll();
    if (!all.length){ alert('Henüz kayıt yok.'); return; }
    const csv = toCsv(all);
    download('TTFKD_Toplanan_Yanitlar.csv', csv);
  });
})();
</script>
</body>
</html>
